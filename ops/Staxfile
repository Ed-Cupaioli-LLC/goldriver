require_relative 'lib/stack'
require_relative 'lib/stax/cli/reap'

def ap_tags
  tag 'ap:app',     :
  tag 'ap:branch',  Stax::Git.branch
end

stack :bucket
stack :build, import: :bucket

group :optional do
  stack :cdn,   import: :bucket
  stack :vpc
  stack :proxy,     import: [:vpc, :bucket]
  stack :dashboard, import: [:cdn, :build]
end
